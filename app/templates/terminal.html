<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>{{name}} Terminal</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css" />
  <script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/socket.io/client-dist/socket.io.js"></script>

  <style>
    body { margin: 0; height: 100vh; display: flex; }
    #terminal { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="terminal"></div>
<script>
  const term = new Terminal();
  term.open(document.getElementById("terminal"));
  const socket = io("https://dashboard.smallshardz.com",{
  transports: ["websocket", "polling"],
});

  socket.on("output", function(msg) {
    term.write(msg.data.replace(/\n/g, "\r\n"));
  });

  let currentLine = "";
  term.onData(function(data) {
    if (data.charCodeAt(0) === 13) { // Enter
      socket.emit("input", currentLine);
      currentLine = "";
    } else if (data.charCodeAt(0) === 127) { // Backspace
      if (currentLine.length > 0) {
        currentLine = currentLine.slice(0, -1);
        term.write("\b \b");
      }
    } else {
      currentLine += data;
      term.write(data);
    }
  });
</script>
</body>
</html>